{% extends 'base.html' %}

{% load static %}

{% block content %}
<!--배경-->
<div class="page-bg-wrapper">
  <div class="page-bg-inner">
    <div class="container container-pt white-font">
      <!--결과-->
      <p class="title-size result-title">'{{ key_word }}' 검색 결과</p>
      <p class="title-size result-title">{{ total_results }}건의 결과</p>
      
<!--영화 START-->
{% if results %}
    <!-- 영화일경우-->
    <p class="title-size result-text">영화</p>
    <div class="search-card-wrap">
        {% for result in results %}
            {% if result.overview %}
                <a class="search-card" href="{% url 'movies:detail' result.id %}">
                    <img class="poster-size" src="https://image.tmdb.org/t/p/w500{{ result.poster_path }}" alt="{{ result.title }}">
                    <p class="white-movie-title">{{ result.title }}</p>
                    <p class="white-movie-content">{{ result.release_date|slice:":4" }}</p>
                    <p class="white-movie-avg">평점<img class="star-size" src="{% static 'img/rating-star.svg' %}" alt="">{{ result.vote_average|floatformat:1 }}</p>
                </a>
            {% endif %}
        {% endfor %}
{% else %}
    <p class="result-text-none">검색 결과가 없습니다.</p>
{% endif %}
<!--영화 END-->

<!--인물 START-->
{% if results %}
    <!-- 인물일경우 -->
    <p class="title-size result-text">인물</p>
    <div class="search-card-wrap">
        {% for result in results %}
            {% if result.profile_path %}
                <a class="search-card"href="{% url 'movies:person_detail' result.id %}">
                    <img class="poster-size" src="https://image.tmdb.org/t/p/w500{{ result.profile_path }}" alt="{{ result.name }}">
                    <p class="white-movie-title">{{ result.name }}</p>
                    <p class="white-movie-content">대표작: {{ result.known_for.0.title }}</p>
                </a>
            {% endif %}
        {% endfor %}
    {% else %}
        <p class="result-text-none">검색 결과가 없습니다.</p>
    {% endif %}
    </div>
<!--인물 END-->

    </div>
  </div>
</div>
    <!-- 페이지 -->
    <div class="pagination justify-content-center">
      <ul class="pagination my-5">
        {% if pages.has_previous %}
          <li class="page-item">
            {% if pages.previous_page_number == 1 %}
              <a class="page-link" href="?search={{ key_word }}&page={{ pages.previous_page_number }}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
                <span class="sr-only">Previous</span>
              </a>
            {% else %}
              <a class="page-link" href="?search={{ key_word }}&page=1" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
                <span class="sr-only">First</span>
              </a>
            {% endif %}
          </li>
        {% endif %}
        
        {% for page_num in pages.paginator.page_range %}
          {% if page_num > pages.number|add:'-3' and page_num < pages.number|add:'3' %}
            <li class="page-item {% if pages.number == page_num %} active{% endif %}">
              <a class="page-link" href="?search={{ key_word }}&page={{ page_num }}">{{ page_num }}</a>
            </li>
          {% endif %}
        {% endfor %}
        
        {% if pages.has_next %}
          <li class="page-item">
            {% if pages.next_page_number == pages.paginator.num_pages %}
              <a class="page-link" href="?search={{ key_word }}&page={{ pages.next_page_number }}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
                <span class="sr-only">Next</span>
              </a>
            {% else %}
              <a class="page-link" href="?search={{ key_word }}&page={{ pages.paginator.num_pages }}" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
                <span class="sr-only">Last</span>
              </a>
            {% endif %}
          </li>
        {% endif %}
      </ul>
    </div>

    </div>
  </div>
</div>

{% endblock content %}